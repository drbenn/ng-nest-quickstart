{
  "version": 3,
  "sources": ["../../../../../../node_modules/@ngxs/devtools-plugin/fesm2022/ngxs-devtools-plugin.mjs"],
  "sourcesContent": ["import * as i0 from '@angular/core';\nimport { InjectionToken, inject, Injector, NgZone, ɵglobal as _global, Injectable, NgModule, makeEnvironmentProviders } from '@angular/core';\nimport { Store, withNgxsPlugin } from '@ngxs/store';\nimport { getActionTypeFromInstance, InitState } from '@ngxs/store/plugins';\nimport { catchError, tap } from 'rxjs/operators';\nconst NGXS_DEVTOOLS_OPTIONS = new InjectionToken('NGXS_DEVTOOLS_OPTIONS');\n\n/**\n * Adds support for the Redux Devtools extension:\n * http://extension.remotedev.io/\n */\nclass NgxsReduxDevtoolsPlugin {\n  constructor() {\n    this._injector = inject(Injector);\n    this._ngZone = inject(NgZone);\n    this._options = inject(NGXS_DEVTOOLS_OPTIONS);\n    this.devtoolsExtension = null;\n    this.globalDevtools = _global['__REDUX_DEVTOOLS_EXTENSION__'] || _global['devToolsExtension'];\n    this.unsubscribe = null;\n    this.connect();\n  }\n  ngOnDestroy() {\n    this.unsubscribe?.();\n    this.globalDevtools?.disconnect();\n  }\n  /**\n   * Lazy get the store for circular dependency issues\n   */\n  get store() {\n    return this._injector.get(Store);\n  }\n  /**\n   * Middleware handle function\n   */\n  handle(state, action, next) {\n    if (!this.devtoolsExtension || this._options.disabled) {\n      return next(state, action);\n    }\n    return next(state, action).pipe(catchError(error => {\n      const newState = this.store.snapshot();\n      this.sendToDevTools(state, action, newState);\n      throw error;\n    }), tap(newState => {\n      this.sendToDevTools(state, action, newState);\n    }));\n  }\n  sendToDevTools(state, action, newState) {\n    const type = getActionTypeFromInstance(action);\n    // if init action, send initial state to dev tools\n    const isInitAction = type === InitState.type;\n    if (isInitAction) {\n      this.devtoolsExtension.init(state);\n    } else {\n      this.devtoolsExtension.send({\n        ...action,\n        action: null,\n        type\n      }, newState);\n    }\n  }\n  /**\n   * Handle the action from the dev tools subscription\n   */\n  dispatched(action) {\n    if (action.type === \"DISPATCH\" /* ReduxDevtoolsActionType.Dispatch */) {\n      if (action.payload.type === \"JUMP_TO_ACTION\" /* ReduxDevtoolsPayloadType.JumpToAction */ || action.payload.type === \"JUMP_TO_STATE\" /* ReduxDevtoolsPayloadType.JumpToState */) {\n        const prevState = JSON.parse(action.state);\n        // This makes the DevTools and Router plugins compatible with each other.\n        // We check for the existence of the `router` state and ensure it has the\n        // `trigger` property, confirming that it is our router state (coming from `@ngxs/router-plugin`).\n        // This enables a time-traveling feature, as it not only restores the state but\n        // also allows the `RouterState` to navigate back when the action is jumped.\n        if (prevState.router && prevState.router.trigger) {\n          prevState.router.trigger = 'devtools';\n        }\n        this.store.reset(prevState);\n      } else if (action.payload.type === \"TOGGLE_ACTION\" /* ReduxDevtoolsPayloadType.ToggleAction */) {\n        console.warn('Skip is not supported at this time.');\n      } else if (action.payload.type === \"IMPORT_STATE\" /* ReduxDevtoolsPayloadType.ImportState */) {\n        const {\n          actionsById,\n          computedStates,\n          currentStateIndex\n        } = action.payload.nextLiftedState;\n        this.devtoolsExtension.init(computedStates[0].state);\n        Object.keys(actionsById).filter(actionId => actionId !== '0').forEach(actionId => this.devtoolsExtension.send(actionsById[actionId], computedStates[actionId].state));\n        this.store.reset(computedStates[currentStateIndex].state);\n      }\n    } else if (action.type === \"ACTION\" /* ReduxDevtoolsActionType.Action */) {\n      const actionPayload = JSON.parse(action.payload);\n      this.store.dispatch(actionPayload);\n    }\n  }\n  connect() {\n    if (!this.globalDevtools || this._options.disabled) {\n      return;\n    }\n    // The `connect` method adds a `message` event listener to communicate\n    // with an extension through `window.postMessage` and handle message events.\n    // Since we only handle two specific events, we aim to avoid unnecessary change\n    // detections triggered by events that the extension sends, but we don't need to handle.\n    this.devtoolsExtension = this._ngZone.runOutsideAngular(() => this.globalDevtools.connect(this._options));\n    this.unsubscribe = this.devtoolsExtension.subscribe(action => {\n      if (action.type === \"DISPATCH\" /* ReduxDevtoolsActionType.Dispatch */ || action.type === \"ACTION\" /* ReduxDevtoolsActionType.Action */) {\n        this.dispatched(action);\n      }\n    });\n  }\n  /** @nocollapse */\n  static {\n    this.ɵfac = function NgxsReduxDevtoolsPlugin_Factory(__ngFactoryType__) {\n      return new (__ngFactoryType__ || NgxsReduxDevtoolsPlugin)();\n    };\n  }\n  /** @nocollapse */\n  static {\n    this.ɵprov = /* @__PURE__ */i0.ɵɵdefineInjectable({\n      token: NgxsReduxDevtoolsPlugin,\n      factory: NgxsReduxDevtoolsPlugin.ɵfac\n    });\n  }\n}\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && i0.ɵsetClassMetadata(NgxsReduxDevtoolsPlugin, [{\n    type: Injectable\n  }], () => [], null);\n})();\nfunction devtoolsOptionsFactory(options) {\n  return {\n    name: 'NGXS',\n    ...options\n  };\n}\nconst USER_OPTIONS = new InjectionToken('USER_OPTIONS');\nclass NgxsReduxDevtoolsPluginModule {\n  static forRoot(options) {\n    return {\n      ngModule: NgxsReduxDevtoolsPluginModule,\n      providers: [withNgxsPlugin(NgxsReduxDevtoolsPlugin), {\n        provide: USER_OPTIONS,\n        useValue: options\n      }, {\n        provide: NGXS_DEVTOOLS_OPTIONS,\n        useFactory: devtoolsOptionsFactory,\n        deps: [USER_OPTIONS]\n      }]\n    };\n  }\n  /** @nocollapse */\n  static {\n    this.ɵfac = function NgxsReduxDevtoolsPluginModule_Factory(__ngFactoryType__) {\n      return new (__ngFactoryType__ || NgxsReduxDevtoolsPluginModule)();\n    };\n  }\n  /** @nocollapse */\n  static {\n    this.ɵmod = /* @__PURE__ */i0.ɵɵdefineNgModule({\n      type: NgxsReduxDevtoolsPluginModule\n    });\n  }\n  /** @nocollapse */\n  static {\n    this.ɵinj = /* @__PURE__ */i0.ɵɵdefineInjector({});\n  }\n}\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && i0.ɵsetClassMetadata(NgxsReduxDevtoolsPluginModule, [{\n    type: NgModule\n  }], null, null);\n})();\nfunction withNgxsReduxDevtoolsPlugin(options) {\n  return makeEnvironmentProviders([withNgxsPlugin(NgxsReduxDevtoolsPlugin), {\n    provide: USER_OPTIONS,\n    useValue: options\n  }, {\n    provide: NGXS_DEVTOOLS_OPTIONS,\n    useFactory: devtoolsOptionsFactory,\n    deps: [USER_OPTIONS]\n  }]);\n}\n\n/**\n * The public api for consumers of @ngxs/devtools-plugin\n */\n\n/**\n * Generated bundle index. Do not edit.\n */\n\nexport { NGXS_DEVTOOLS_OPTIONS, NgxsReduxDevtoolsPlugin, NgxsReduxDevtoolsPluginModule, withNgxsReduxDevtoolsPlugin };\n"],
  "mappings": "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",
  "names": []
}
